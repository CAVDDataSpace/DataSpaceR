---
title: "Monoclonal Antibodies"
author: "Ju Yeong Kim"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


## Workflow

In the app, the workflow of using the mAb grid looks like this:

1. Navigate to the mAb Grid and browse the available mAb mixtures
2. Select the mAb mixtures that you'd like to investigate
3. Or filter columns by mAb/Mixture, donor species, isotype, HXB2 location, tiers, clades, and viruses
4. Click "Neutralization Curves" or "IC50 Titer Heatmap" to visualize mAb data
5. Click "Export CSV" or "Export Excel" to download mAb data

`DataSpaceR` can mimick these steps except for the step 4.

1. Browse `con$mabGrid`
2. Use `con$filterMabGrid()`
3. Use `con$filterMabGrid()`
4. Currently not available
5. Use `con$getMab()` to retreive mAb data


## Browse the mAb Grid

```{r}
library(DataSpaceR)
con <- connectDS()

DT::datatable(con$mabGrid, options=list(autoWidth = TRUE, scrollX = TRUE))
```


## Filter the mAb grid

```{r}
# filter the grid by HXB2 location (Env and 249M Gag)
con$filterMabGrid(using = "hxb2_location", value = c("Env", "Gag"))

# filter the grid by species (llama)
con$filterMabGrid(using = "donor_species", value = "llama")

# check the updated grid
DT::datatable(con$mabGrid, options=list(autoWidth = TRUE, scrollX = TRUE))
```

```{r eval=FALSE}
# Or
con$filterMabGrid(using = "hxb2_location", value = c("Env", "Gag"))$filterMabGrid(using = "donor_species", value = "llama")$mabGrid
```


## Retrive column values from the mAb grid

You can retrive values from the grid by MAb Mixture, donor species, isotype, HXB2 location, tiers, clades, and viruses.

```{r}
# retrieve available viruses in the grid
con$retrieveMabGridValue(using = "viruses")

# retrive available clades for 1H9 mAb mixture in the grid
con$retrieveMabGridValue(using = "clades", mAb_mixture = "1H9")
```


## Create a DataSpaceMab object

After filtering the grid, you can create a DataSpaceMab object that contains the filtered mAb data.

```{r}
mab <- con$getMab()
mab
```

```{r}
DT::datatable(mab$nabMab, options=list(autoWidth = TRUE, scrollX = TRUE))
```


## Session information

```{r session-info}
sessionInfo()
```
